<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C Code Analyzer - Data Flow Diagram</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #f8f9fa;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .diagram-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            padding: 30px;
            max-width: 1200px;
        }
        h1 {
            text-align: center;
            color: #1F4E79;
            margin-bottom: 30px;
            font-size: 24px;
        }
        svg {
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="diagram-container">
        <h1>C Code Analyzer - Data Flow Architecture</h1>
        <svg width="1100" height="850" viewBox="0 0 1100 850">
            <defs>
                <!-- Gradients -->
                <linearGradient id="blueGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#4A90D9;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#1F4E79;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="greenGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#5CB85C;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#3D8B3D;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="orangeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#F0AD4E;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#EC971F;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="purpleGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#9B59B6;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#7D3C98;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="tealGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#17A2B8;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#117A8B;stop-opacity:1" />
                </linearGradient>
                
                <!-- Arrow marker -->
                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#555"/>
                </marker>
                <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#1F4E79"/>
                </marker>
                
                <!-- Drop shadow -->
                <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
                    <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.2"/>
                </filter>
            </defs>
            
            <!-- Background sections -->
            <rect x="20" y="20" width="350" height="320" rx="10" fill="#E8F4FD" opacity="0.5"/>
            <text x="195" y="50" font-size="14" font-weight="bold" fill="#1F4E79" text-anchor="middle">Phase 1: Dependency Resolution</text>
            
            <rect x="400" y="20" width="300" height="320" rx="10" fill="#FFF3CD" opacity="0.5"/>
            <text x="550" y="50" font-size="14" font-weight="bold" fill="#856404" text-anchor="middle">Phase 2: Function Registry</text>
            
            <rect x="730" y="20" width="350" height="320" rx="10" fill="#D4EDDA" opacity="0.5"/>
            <text x="905" y="50" font-size="14" font-weight="bold" fill="#155724" text-anchor="middle">Phase 3: Agentic Tools</text>
            
            <rect x="20" y="360" width="1060" height="470" rx="10" fill="#F8D7DA" opacity="0.3"/>
            <text x="550" y="390" font-size="14" font-weight="bold" fill="#721C24" text-anchor="middle">Phase 4: Agent Execution Flow</text>
            
            <!-- Phase 1: Dependency Resolution -->
            <!-- Makefile -->
            <rect x="95" y="70" width="200" height="50" rx="8" fill="url(#blueGrad)" filter="url(#shadow)"/>
            <text x="195" y="100" font-size="13" fill="white" text-anchor="middle" font-weight="bold">Makefile (SRCS field)</text>
            
            <!-- Arrow -->
            <line x1="195" y1="120" x2="195" y2="145" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            
            <!-- .c Files -->
            <rect x="95" y="150" width="200" height="50" rx="8" fill="url(#tealGrad)" filter="url(#shadow)"/>
            <text x="195" y="180" font-size="13" fill="white" text-anchor="middle" font-weight="bold">.c Source Files</text>
            
            <!-- Arrow -->
            <line x1="195" y1="200" x2="195" y2="225" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            
            <!-- Header Extraction -->
            <rect x="70" y="230" width="250" height="50" rx="8" fill="url(#purpleGrad)" filter="url(#shadow)"/>
            <text x="195" y="252" font-size="12" fill="white" text-anchor="middle">Extract #include headers</text>
            <text x="195" y="268" font-size="12" fill="white" text-anchor="middle">Resolve paths recursively</text>
            
            <!-- Arrow -->
            <line x1="195" y1="280" x2="195" y2="305" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            
            <!-- Header Dictionary -->
            <rect x="55" y="310" width="280" height="50" rx="8" fill="url(#greenGrad)" filter="url(#shadow)"/>
            <text x="195" y="340" font-size="13" fill="white" text-anchor="middle" font-weight="bold">Header-to-Path Dictionary</text>
            
            <!-- Phase 2: Function Registry -->
            <!-- Excel -->
            <rect x="420" y="70" width="120" height="45" rx="8" fill="url(#orangeGrad)" filter="url(#shadow)"/>
            <text x="480" y="98" font-size="12" fill="white" text-anchor="middle" font-weight="bold">Excel Sheet</text>
            
            <!-- PDF -->
            <rect x="560" y="70" width="120" height="45" rx="8" fill="url(#orangeGrad)" filter="url(#shadow)"/>
            <text x="620" y="92" font-size="12" fill="white" text-anchor="middle" font-weight="bold">Moove Header</text>
            <text x="620" y="106" font-size="12" fill="white" text-anchor="middle" font-weight="bold">PDF</text>
            
            <!-- Arrows to JSON -->
            <line x1="480" y1="115" x2="480" y2="140" stroke="#555" stroke-width="2"/>
            <line x1="620" y1="115" x2="620" y2="140" stroke="#555" stroke-width="2"/>
            <line x1="480" y1="140" x2="550" y2="160" stroke="#555" stroke-width="2"/>
            <line x1="620" y1="140" x2="550" y2="160" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            
            <!-- JSON File -->
            <rect x="460" y="165" width="180" height="50" rx="8" fill="url(#blueGrad)" filter="url(#shadow)"/>
            <text x="550" y="188" font-size="12" fill="white" text-anchor="middle" font-weight="bold">JSON Function Info</text>
            <text x="550" y="203" font-size="10" fill="white" text-anchor="middle">(prototypes, args, callbacks)</text>
            
            <!-- Arrow -->
            <line x1="550" y1="215" x2="550" y2="245" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            
            <!-- Pickle Files -->
            <rect x="460" y="250" width="180" height="50" rx="8" fill="url(#purpleGrad)" filter="url(#shadow)"/>
            <text x="550" y="273" font-size="12" fill="white" text-anchor="middle" font-weight="bold">Pickle Files</text>
            <text x="550" y="288" font-size="10" fill="white" text-anchor="middle">(serialized for fast loading)</text>
            
            <!-- Arrow -->
            <line x1="550" y1="300" x2="550" y2="330" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            
            <!-- Function Map -->
            <rect x="430" y="310" width="240" height="50" rx="8" fill="url(#greenGrad)" filter="url(#shadow)"/>
            <text x="550" y="332" font-size="11" fill="white" text-anchor="middle" font-weight="bold">{func_name: func_info}</text>
            <text x="550" y="348" font-size="10" fill="white" text-anchor="middle">Function Registry Map</text>
            
            <!-- Phase 3: Agentic Tools -->
            <!-- Tool boxes -->
            <rect x="760" y="70" width="290" height="55" rx="8" fill="url(#blueGrad)" filter="url(#shadow)"/>
            <text x="905" y="92" font-size="12" fill="white" text-anchor="middle" font-weight="bold">read_file_content</text>
            <text x="905" y="108" font-size="10" fill="white" text-anchor="middle">path, function_name → file content</text>
            
            <rect x="760" y="135" width="290" height="55" rx="8" fill="url(#tealGrad)" filter="url(#shadow)"/>
            <text x="905" y="157" font-size="12" fill="white" text-anchor="middle" font-weight="bold">list_project_files</text>
            <text x="905" y="173" font-size="10" fill="white" text-anchor="middle">filter_keywords → accessible file paths</text>
            
            <rect x="760" y="200" width="290" height="55" rx="8" fill="url(#orangeGrad)" filter="url(#shadow)"/>
            <text x="905" y="222" font-size="12" fill="white" text-anchor="middle" font-weight="bold">lookup_function_reference</text>
            <text x="905" y="238" font-size="10" fill="white" text-anchor="middle">function_name → prototype info</text>
            
            <rect x="760" y="265" width="290" height="55" rx="8" fill="url(#purpleGrad)" filter="url(#shadow)"/>
            <text x="905" y="287" font-size="12" fill="white" text-anchor="middle" font-weight="bold">find_definition</text>
            <text x="905" y="303" font-size="10" fill="white" text-anchor="middle">symbol_name → definition location</text>
            
            <!-- Phase 4: Agent Execution Flow -->
            <!-- LLM Agent -->
            <ellipse cx="550" cy="450" rx="100" ry="40" fill="url(#blueGrad)" filter="url(#shadow)"/>
            <text x="550" y="445" font-size="14" fill="white" text-anchor="middle" font-weight="bold">LLM Agent</text>
            <text x="550" y="462" font-size="11" fill="white" text-anchor="middle">Controller</text>
            
            <!-- Start: main() -->
            <rect x="70" y="420" width="180" height="60" rx="8" fill="url(#greenGrad)" filter="url(#shadow)"/>
            <text x="160" y="445" font-size="12" fill="white" text-anchor="middle" font-weight="bold">1. Start from main()</text>
            <text x="160" y="462" font-size="10" fill="white" text-anchor="middle">read_file_content</text>
            <text x="160" y="476" font-size="10" fill="white" text-anchor="middle">(path, "main")</text>
            
            <!-- Arrow from Start to Agent -->
            <line x1="250" y1="450" x2="445" y2="450" stroke="#1F4E79" stroke-width="2" marker-end="url(#arrowhead-blue)"/>
            
            <!-- Decision diamond -->
            <polygon points="550,520 620,570 550,620 480,570" fill="url(#orangeGrad)" filter="url(#shadow)"/>
            <text x="550" y="565" font-size="11" fill="white" text-anchor="middle" font-weight="bold">Unknown</text>
            <text x="550" y="580" font-size="11" fill="white" text-anchor="middle" font-weight="bold">Function?</text>
            
            <!-- Arrow from Agent to Decision -->
            <line x1="550" y1="490" x2="550" y2="520" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            
            <!-- Step 2: lookup_function_reference -->
            <rect x="700" y="540" width="220" height="60" rx="8" fill="url(#orangeGrad)" filter="url(#shadow)"/>
            <text x="810" y="565" font-size="12" fill="white" text-anchor="middle" font-weight="bold">2. lookup_function_reference</text>
            <text x="810" y="582" font-size="10" fill="white" text-anchor="middle">Check function registry first</text>
            
            <!-- Arrow from Decision to Step 2 -->
            <line x1="620" y1="570" x2="695" y2="570" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            <text x="657" y="560" font-size="10" fill="#555" font-weight="bold">Yes</text>
            
            <!-- Decision 2: Found? -->
            <polygon points="810,640 860,680 810,720 760,680" fill="url(#tealGrad)" filter="url(#shadow)"/>
            <text x="810" y="683" font-size="10" fill="white" text-anchor="middle" font-weight="bold">Found?</text>
            
            <!-- Arrow from Step 2 to Decision 2 -->
            <line x1="810" y1="600" x2="810" y2="640" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            
            <!-- Step 3: find_definition -->
            <rect x="900" y="650" width="180" height="60" rx="8" fill="url(#purpleGrad)" filter="url(#shadow)"/>
            <text x="990" y="675" font-size="12" fill="white" text-anchor="middle" font-weight="bold">3. find_definition</text>
            <text x="990" y="692" font-size="10" fill="white" text-anchor="middle">Fallback for symbols</text>
            
            <!-- Arrow from Decision 2 to Step 3 -->
            <line x1="860" y1="680" x2="895" y2="680" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            <text x="877" y="670" font-size="10" fill="#555" font-weight="bold">No</text>
            
            <!-- Continue Analysis -->
            <rect x="180" y="540" width="200" height="60" rx="8" fill="url(#tealGrad)" filter="url(#shadow)"/>
            <text x="280" y="565" font-size="12" fill="white" text-anchor="middle" font-weight="bold">Continue Analysis</text>
            <text x="280" y="582" font-size="10" fill="white" text-anchor="middle">Process next function</text>
            
            <!-- Arrow from Decision to Continue (No path) -->
            <line x1="480" y1="570" x2="385" y2="570" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            <text x="432" y="560" font-size="10" fill="#555" font-weight="bold">No</text>
            
            <!-- Arrow from Continue back to Agent -->
            <path d="M 280 540 L 280 470 Q 280 450 300 450 L 445 450" fill="none" stroke="#1F4E79" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead-blue)"/>
            
            <!-- Arrow from Decision 2 Yes to Analysis -->
            <path d="M 760 680 L 280 680 L 280 605" fill="none" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            <text x="520" y="670" font-size="10" fill="#555" font-weight="bold">Yes (use info)</text>
            
            <!-- Arrow from Step 3 to Analysis -->
            <path d="M 990 710 L 990 760 L 280 760 L 280 605" fill="none" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            
            <!-- Output -->
            <rect x="70" y="650" width="180" height="60" rx="8" fill="url(#greenGrad)" filter="url(#shadow)"/>
            <text x="160" y="675" font-size="12" fill="white" text-anchor="middle" font-weight="bold">Analysis Complete</text>
            <text x="160" y="692" font-size="10" fill="white" text-anchor="middle">Code comprehension output</text>
            
            <!-- Arrow from Continue to Output (when done) -->
            <line x1="280" y1="600" x2="280" y2="630" stroke="#555" stroke-width="1" stroke-dasharray="3,3"/>
            <line x1="280" y1="630" x2="160" y2="630" stroke="#555" stroke-width="1" stroke-dasharray="3,3"/>
            <line x1="160" y1="630" x2="160" y2="645" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            <text x="220" y="622" font-size="9" fill="#555">done</text>
            
            <!-- Legend -->
            <rect x="70" y="780" width="1010" height="50" rx="5" fill="#f0f0f0" stroke="#ddd"/>
            <text x="90" y="810" font-size="11" fill="#333" font-weight="bold">Legend:</text>
            <rect x="150" y="795" width="20" height="15" rx="3" fill="url(#blueGrad)"/>
            <text x="175" y="807" font-size="10" fill="#333">Input/Process</text>
            <rect x="270" y="795" width="20" height="15" rx="3" fill="url(#greenGrad)"/>
            <text x="295" y="807" font-size="10" fill="#333">Output/Start</text>
            <rect x="380" y="795" width="20" height="15" rx="3" fill="url(#orangeGrad)"/>
            <text x="405" y="807" font-size="10" fill="#333">Tool/Decision</text>
            <rect x="500" y="795" width="20" height="15" rx="3" fill="url(#purpleGrad)"/>
            <text x="525" y="807" font-size="10" fill="#333">Transform</text>
            <rect x="610" y="795" width="20" height="15" rx="3" fill="url(#tealGrad)"/>
            <text x="635" y="807" font-size="10" fill="#333">File/Continue</text>
            <line x1="720" y1="802" x2="760" y2="802" stroke="#555" stroke-width="2" marker-end="url(#arrowhead)"/>
            <text x="770" y="807" font-size="10" fill="#333">Flow</text>
            <line x1="820" y1="802" x2="860" y2="802" stroke="#1F4E79" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead-blue)"/>
            <text x="870" y="807" font-size="10" fill="#333">Loop</text>
        </svg>
    </div>
</body>
</html>
